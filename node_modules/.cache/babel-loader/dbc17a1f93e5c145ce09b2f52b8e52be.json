{"ast":null,"code":"import _objectSpread from\"/home/adib/code/rhino_production/rhino/rhino-front/rhino/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/home/adib/code/rhino_production/rhino/rhino-front/rhino/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect,useContext}from\"react\";import ReactMapGL,{Marker,Popup}from\"react-map-gl\";import{useNavigate}from'react-router-dom';import axios from'axios';import'mapbox-gl/dist/mapbox-gl.css';import Context from'./Context';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var GeoMap=function GeoMap(){var navigate=useNavigate();var context=useContext(Context);var data=context?context.userdata:null;var id=data?data.id:null;var before_adress=data?data.adress:null;console.log(id);var _useState=useState(''),_useState2=_slicedToArray(_useState,2),search=_useState2[0],setSearch=_useState2[1];var _useState3=useState(before_adress||null),_useState4=_slicedToArray(_useState3,2),adress=_useState4[0],setAdress=_useState4[1];var _useState5=useState({latitude:23.7531959,longitude:90.4374604}),_useState6=_slicedToArray(_useState5,2),viewport=_useState6[0],setViewport=_useState6[1];useEffect(function(){console.log(viewport);},[viewport]);useEffect(function(){console.log(viewport);if(\"geolocation\"in navigator){console.log('available');navigator.geolocation.getCurrentPosition(function(position){console.log(position.coords.latitude,position.coords.longitude);setViewport({latitude:position.coords.latitude,longitude:position.coords.longitude});console.log(viewport,'vee');});}else{console.log('bug');}},[]);var onMarkerDragStart=function onMarkerDragStart(event){var latitude=event.latitude,longitude=event.longitude;};var onDragEnd=function onDragEnd(event){if(event.lngLat){var url=\"https://api.geoapify.com/v1/geocode/reverse?lat=\".concat(event.lngLat.lat,\"&lon=\").concat(event.lngLat.lng,\"&apiKey=24d9c36345a346f1be7bc3c92cf1f26b\");axios.get(url).then(function(response){console.log(response.data.features[0].properties.formatted);setAdress(response.data.features[0].properties.formatted);setViewport({latitude:response.data.features[0].geometry.coordinates[1],longitude:response.data.features[0].geometry.coordinates[0]});}).catch(function(err){console.log(err);});}};var onMarkerDrag=function onMarkerDrag(event){var latitude=event.latitude,longitude=event.longitude;};var geoCode=function geoCode(){if(search){var url=\"https://api.geoapify.com/v1/geocode/search?text=\".concat(search,\"&apiKey=24d9c36345a346f1be7bc3c92cf1f26b\");axios.get(url).then(function(response){console.log(response.data.features[0].geometry.coordinates);setViewport({latitude:response.data.features[0].geometry.coordinates[1],longitude:response.data.features[0].geometry.coordinates[0]});}).catch(function(err){console.log(err);});}};var changeAdress=function changeAdress(){var url='https://rhino-backend.up.railway.app/update/';axios.post(url,{id:id,adress:adress}).then(function(response){console.log(response.data);navigate('/');window.location.reload(false);}).catch(function(err){console.log(err);});};return/*#__PURE__*/_jsxs(\"div\",{className:\"map-cont\",children:[viewport?/*#__PURE__*/_jsx(ReactMapGL,_objectSpread(_objectSpread({},viewport),{},{latitude:viewport.latitude,longitude:viewport.longitude,width:\"100vw\",height:\"1000vh\",zoom:15,mapboxAccessToken:\"pk.eyJ1IjoiYWRpYmtoYW5kZXYiLCJhIjoiY2xnNWt4YW85MDRsaTNpcGQ5djFrdWhyYiJ9.T5M-84Av38RJSb1j1Bp6Iw\",mapStyle:\"mapbox://styles/adibkhandev/clg6ih4pd009y01p0dup15qd7\",onMove:function onMove(evt){setViewport(_objectSpread(_objectSpread({},evt),{},{latitude:viewport.latitude,longitude:viewport.longitude}));console.log('hocche',evt);},children:/*#__PURE__*/_jsx(Marker,{draggable:true,latitude:viewport.latitude||23.7531959,longitude:viewport.longitude||90.4374604,onDragStart:onMarkerDragStart,onDragEnd:onDragEnd,onDrag:onMarkerDrag})})):'hi',/*#__PURE__*/_jsx(\"div\",{className:\"nav-cont\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"nav\",children:[/*#__PURE__*/_jsx(\"div\",{onClick:geoCode,className:\"search-btn\",children:/*#__PURE__*/_jsx(\"img\",{src:\"images/search-ash.png\",alt:\"\"})}),/*#__PURE__*/_jsx(\"input\",{placeholder:!adress?\"Search Location\":'',value:adress||search,onChange:function onChange(e){return setSearch(e.target.value);},className:\"location-search\",type:\"text\"}),/*#__PURE__*/_jsx(\"div\",{onClick:changeAdress,className:\"target\",children:/*#__PURE__*/_jsx(\"img\",{src:\"images/target.png\",alt:\"\"})})]})})]});};export default GeoMap;","map":{"version":3,"names":["React","useState","useEffect","useContext","ReactMapGL","Marker","Popup","useNavigate","axios","Context","GeoMap","navigate","context","data","userdata","id","before_adress","adress","console","log","search","setSearch","setAdress","latitude","longitude","viewport","setViewport","navigator","geolocation","getCurrentPosition","position","coords","onMarkerDragStart","event","onDragEnd","lngLat","url","lat","lng","get","then","response","features","properties","formatted","geometry","coordinates","catch","err","onMarkerDrag","geoCode","changeAdress","post","window","location","reload","evt","e","target","value"],"sources":["/home/adib/code/rhino_production/rhino/rhino-front/rhino/src/all-pages/GeoMap.js"],"sourcesContent":["import React, { useState, useEffect,useContext} from \"react\";\nimport ReactMapGL, { Marker, Popup } from \"react-map-gl\";\nimport {useNavigate} from 'react-router-dom'\nimport axios from 'axios'\nimport 'mapbox-gl/dist/mapbox-gl.css';\nimport Context from './Context'\n\nlet GeoMap = ()=> {\n  let navigate = useNavigate()\n  let context = useContext(Context)\n  let data = context? context.userdata : null\n  let id = data? data.id : null\n  let before_adress = data? data.adress : null\n  console.log(id)\n  let [search,setSearch]=useState('')\n  let [adress,setAdress] = useState(before_adress || null)\n  const [viewport, setViewport] = useState({latitude: 23.7531959, longitude: 90.4374604});\n  useEffect(() => {\n    console.log(viewport)\n  }, [viewport])\n  useEffect(() => {\n    console.log(viewport)\n    if(\"geolocation\" in navigator){\n      console.log('available')\n      navigator.geolocation.getCurrentPosition((position)=>{\n        console.log(position.coords.latitude,position.coords.longitude)\n        setViewport({\n          latitude:position.coords.latitude,\n          longitude:position.coords.longitude,\n        })\n        console.log(viewport,'vee')\n      })\n    }\n    else{\n      console.log('bug')\n    }\n  },[])\n\n  let onMarkerDragStart = (event) => {\n    const {latitude, longitude} = event;\n   \n  }\n\n  let onDragEnd = (event) => {\n    \n    if(event.lngLat){\n      let url =`https://api.geoapify.com/v1/geocode/reverse?lat=${event.lngLat.lat}&lon=${event.lngLat.lng}&apiKey=24d9c36345a346f1be7bc3c92cf1f26b`\n      axios.get(url)\n       .then((response)=>{\n        console.log(response.data.features[0].properties.formatted)\n        setAdress(response.data.features[0].properties.formatted)\n        setViewport({\n          latitude:response.data.features[0].geometry.coordinates[1],\n          longitude:response.data.features[0].geometry.coordinates[0],\n        })\n       })\n       .catch((err)=>{\n        console.log(err)\n       })\n    }\n  }\n\n  let onMarkerDrag = (event) => {\n    const {latitude, longitude} = event;\n  \n  }\n\n\n  let geoCode = ()=>{\n    if(search){\n    let url = `https://api.geoapify.com/v1/geocode/search?text=${search}&apiKey=24d9c36345a346f1be7bc3c92cf1f26b`\n        axios.get(url)\n       .then((response)=>{\n        console.log(response.data.features[0].geometry.coordinates)\n        setViewport({\n          latitude:response.data.features[0].geometry.coordinates[1],\n          longitude:response.data.features[0].geometry.coordinates[0],\n        })\n       })\n       .catch((err)=>{\n        console.log(err)\n       })\n \n    }\n  }\n\n  let changeAdress = () =>{\n    let url =  'https://rhino-backend.up.railway.app/update/'\n    axios.post(url,{id:id,adress:adress})\n    .then((response)=>{\n      console.log(response.data)\n      \n      navigate('/')\n      window.location.reload(false)\n    })\n    .catch((err)=>{\n      console.log(err)\n    })\n  }\n\n  return (\n    <div className=\"map-cont\">\n      {viewport?(\n\n      <ReactMapGL\n        {...viewport}\n        latitude={viewport.latitude }\n        longitude={viewport.longitude }\n        width= {\"100vw\"}\n        height= {\"1000vh\"}\n        zoom= {15}\n        mapboxAccessToken=\"pk.eyJ1IjoiYWRpYmtoYW5kZXYiLCJhIjoiY2xnNWt4YW85MDRsaTNpcGQ5djFrdWhyYiJ9.T5M-84Av38RJSb1j1Bp6Iw\"\n        mapStyle=\"mapbox://styles/adibkhandev/clg6ih4pd009y01p0dup15qd7\"\n        onMove={(evt) => {\n\n          setViewport({\n            ...evt,\n            latitude:viewport.latitude,\n            longitude:viewport.longitude\n          });\n          console.log('hocche',evt)\n        }}\n       >\n       <Marker \n       draggable \n        latitude={viewport.latitude || 23.7531959}\n        longitude={viewport.longitude || 90.4374604 }\n       onDragStart={onMarkerDragStart}\n       onDragEnd={onDragEnd}\n       onDrag={onMarkerDrag}\n       >\n     \n       </Marker>\n\n      </ReactMapGL>\n      \n\n\n      ):'hi'}\n      \n     <div className=\"nav-cont\">\n       \n      <div className=\"nav\">\n        <div onClick={geoCode} className=\"search-btn\">\n          <img src=\"images/search-ash.png\" alt=\"\"/>\n        </div>\n        <input placeholder={!adress?\"Search Location\":''} value={adress || search} onChange={(e)=>setSearch(e.target.value)} className=\"location-search\" type=\"text\"/>\n        <div onClick={changeAdress} className=\"target\">\n          <img src=\"images/target.png\" alt=\"\"/>\n        </div>\n      </div>\n    </div>\n     </div>\n  );\n}\n\nexport default GeoMap;"],"mappings":"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"},"metadata":{},"sourceType":"module"}